var CandidateApply=function(n){for(var t in n)this[t]=n[t];return this.Initialize(n)};CandidateApply.prototype={Initialize:function(){this.RegisterEvent()},RegisterEvent:function(){this.IsPaging=!1;var n=this;$("#PhoneNumber").val("");document.querySelectorAll("input[data-rule-phone]").forEach(function(n){let t=function(){this.value=this.value.replace(/[^+\d]/g,"")};n.removeEventListener("input",t);n.addEventListener("input",t)});$("#btnSave").unbind("click").click(function(){if(Common.CandidateApply.validatorForm("#form-CandidateApply"),$("#form-CandidateApply").find(".field-validation-error").length==0){var n=$("#form-CandidateApply").serialize();Common.ShowLoading(!0);Common.Ajax({url:Common.CandidateApply.Url.Apply,type:"POST",ContentType:"application/json; charset=utf-8","async":!1,cache:!1,dataType:"JSON",data:n},function(n){Common.ShowLoading(!1);Common.Empty(n)||(n.status==!0?(toastr.success("Gửi thông tin ứng tuyển thành công.!!!","Thông báo",{timeOut:2e3,progressBar:!0,closeButton:!0}),$("#form-CandidateApply").find("input[type=text], textarea").val(""),$("#form-CandidateApply").find("input[type=file]").val(null),$("#form-CandidateApply").find("input[type=radio]").val(0)):toastr.error("Gửi thông tin ứng tuyển thất bại.!!!","Thông báo",{timeOut:2e3,progressBar:!0,closeButton:!0}))})}return!1})},validatorForm:n=>{document.querySelectorAll(n+" .field-validation-error").forEach(function(n){n.parentNode.removeChild(n)}),document.querySelectorAll(n+' input[type="text"][data-rule-required],'+n+' textarea[data-rule-required="true"]').forEach(function(n){if(Common.Empty(n.value)&&Common.Empty(n.getAttribute("disabled"))){var t='<div class="field-validation-error alert alert-danger fade show" role="alert" style="display: block; width:50%">'+n.getAttribute("data-msg-required")+"<\/div>";n.parentNode.insertAdjacentHTML("beforeend",t)}}),document.querySelectorAll(n+' input[type="text"][data-rule-required],'+n+' textarea[data-rule-required="true"]').forEach(function(n){if(!Common.Empty(n.value)&&(/<[a-z][\s\S]*>/i.test(n.value)||/<[/s/S][a-z][\s\S]*>/i.test(n.value)))n.parentNode.insertAdjacentHTML("beforeend",'<div class="field-validation-error alert alert-danger fade show" role="alert" style="display: block; width:50%">Không được chứa mã HTML!!!<\/div>')}),document.querySelectorAll(n+' input[type="text"][data-rule-required],'+n+' textarea[data-rule-required="true"]').forEach(function(n){if(!Common.Empty(n.value)&&Common.Empty(Common.RemoveScript(n.value)))n.parentNode.insertAdjacentHTML("beforeend",'<div class="field-validation-error alert alert-danger fade show" role="alert" style="display: block; width:50%">Không có đoạn Javascript không hợp lệ !!!<\/div>')}),document.querySelectorAll(n+' input[type="text"][data-rule-email]').forEach(function(n){if(!Common.Empty(n.value)&&!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(n.value)&&Common.Empty(n.getAttribute("disabled"))){var t='<div class="field-validation-error alert alert-danger fade show" role="alert" style="display: block; width:50%">'+n.getAttribute("data-msg-email")+"<\/div>";n.parentNode.insertAdjacentHTML("beforeend",t)}}),document.querySelectorAll(n+' input[type="text"][data-rule-min-length],'+n+" textarea[data-rule-min-length]").forEach(function(n){if(!Common.Empty(n.value)&&n.value.length<n.getAttribute("data-rule-min-length")){var t='<div class="field-validation-error alert alert-danger fade show" role="alert" style="display: block; width:50%">'+n.getAttribute("data-msg-min-length")+"<\/div>";n.parentNode.insertAdjacentHTML("beforeend",t)}}),document.querySelectorAll(n+' input[type="file"][data-rule-required]').forEach(function(n){if(Common.Empty(n.value)){var t='<div class="field-validation-error alert alert-danger fade show" role="alert" style="display: block; width:50%">'+n.getAttribute("data-msg-required")+"<\/div>";n.parentNode.insertAdjacentHTML("beforeend",t)}})},UploadFile:function(){$("#AttachmentPath").val("");$("#AttachmentName").val("");let n=$("#fileCV")[0].files,i=n[0].size/1048576;if(!Common.Empty(n)){let i=new RegExp("(doc|DOC|docx|DOCX|pdf|PDF|png|jpg|jpeg|PNG|JPG)$"),r=n[0].name;if(i.test(Common.CandidateApply.getTypeFile(r))){var t=new FormData;n.length>0&&t.append("UploadedFiles",n[0],n[0].name);Common.ShowLoading(!0);Common.Ajax({type:"POST",url:Common.CandidateApply.Url.UploadFile,dataType:"json",data:t,contentType:!1,processData:!1},function(n){Common.ShowLoading(!1);n&&(n.status?(toastr.success("Đính kèm CV thành công.!!!","Thông báo",{timeOut:2e3,progressBar:!0,closeButton:!0}),$("#AttachmentPath").val(n.filePath),$("#AttachmentName").val(n.fileName)):toastr.error("Tải hình lỗi.!!!","Thông báo",{timeOut:2e3,progressBar:!0,closeButton:!0}))})}else return toastr.warning("Vui lòng chọn tệp tin đúng định dạng hình!!!","Thông báo",{timeOut:2e3,progressBar:!0,closeButton:!0}),$("#fileCV").val(null),!1}},getTypeFile:n=>{var t="",i=n!=""?n.lastIndexOf("."):-1,r=n!=""?n.length:-1;return t=n!=""&&i>-1?n.substring(i+1,r):"",t!=""?t.toLowerCase():t}};