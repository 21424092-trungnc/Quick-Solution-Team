var CheckOut=function(n){for(var t in n)this[t]=n[t];return this.Initialize(n)};CheckOut.prototype={Initialize:function(){this.RegisterEvent()},RegisterEvent:function(){$("#btn-login").unbind("click").click(function(){return Common.CheckOut.validatorForm("#form-Login"),$("#form-Login").find(".field-validation-error").length===0&&$("#form-Login").unbind("submit").submit(),!1});document.querySelectorAll("input[data-rule-phone]").forEach(function(n){let t=function(){this.value=this.value.replace(/[^+\d]/g,"")};n.removeEventListener("input",t);n.addEventListener("input",t)});$("#btn-Save").unbind("click").click(function(){if(Common.CheckOut.validatorForm("#form-InsUpd"),$("#form-InsUpd").find(".field-validation-error").length===0){Common.ShowLoading(!0);var n=$("#form-InsUpd").serialize();Common.Ajax({url:Common.CheckOut.Url.Create,type:"POST",ContentType:"application/json; charset=utf-8","async":!1,cache:!1,dataType:"JSON",data:n},function(n){if(Common.ShowLoading(!1),n.status===!0){var t=n.cookieid;Common.createCookie("orderCart",n.cookieid,1);Common.createCookie(t,0,1);toastr.success("Bạn đã mua hàng thành công!","Thông báo",{timeOut:1e3,progressBar:!0,closeButton:!0});window.location="/"}else switch(n.type){case"email":toastr.error("Email đã tồn tại!","Thông báo",{timeOut:5e3,progressBar:!0,closeButton:!0});break;case"phone":toastr.error("Số điện thoại đã tồn tại!","Thông báo",{timeOut:5e3,progressBar:!0,closeButton:!0});break;default:toastr.error("Đã xảy ra lỗi!","Thông báo",{timeOut:5e3,progressBar:!0,closeButton:!0})}})}return!1});$("#btnCartOffer").unbind("click").click(function(){return Common.CheckOut.validatorForm("#form-InsUpd"),$("#form-InsUpd").find(".field-validation-error").length===0&&$("#modalPromotion").modal("Show"),!1});$('input[data-key="inp-Offer"]').unbind("click").change(function(){var t=$(this).val(),n=$(this).closest("tr").attr("data-key"),i=$(this).closest("tr").attr("data-isapply");$(this).is(":checked")?($('input[inp-key="'+n+'"]').not(":checked").prop("disabled",!0),$('tr[data-isapply="false"]').each(function(){$(this).find("input").prop("disabled",!0)})):$('input[inp-key="'+n+'"]').not(":checked").prop("disabled",!1)});$("#SaveCartPromotion").unbind("click").click(function(){var i=[],r,n,t;return $('#modalPromotion tr[name="item"]').each(function(){let n=$(this).find("input");n.is(":checked")&&i.push({PromotionId:n.attr("data-promotionid"),promotionofferid:n.attr("data-promotionofferid"),ProductGiftsId:n.attr("data-productgiftsid"),ProductId:n.attr("data-productid"),DisCountValue:n.attr("data-discountvalue")})}),Common.CheckOut.validatorForm("#form-InsUpd"),$("#form-InsUpd").find(".field-validation-error").length===0&&(r=$("#form-InsUpd").serializeArray(),n={},r.forEach(function(t){t.name.indexOf(".")>-1?n[t.name.split(".")[1]]=t.value:n[t.name]=t.value}),t=new FormData,t.append("dataModel",JSON.stringify(n)),t.append("CartPromotion",JSON.stringify(i)),Common.ShowLoading(!0),$.ajax({type:"POST",contentType:!1,processData:!1,url:Common.CheckOut.Url.CreatePromotion,data:t,dataType:"json",success:function(n){if(Common.ShowLoading(!1),Common.ShowLoading(!1),n.status===!0){var t=n.cookieid;Common.createCookie("orderCart",n.cookieid,1);Common.createCookie(t,0,1);toastr.success("Bạn đã mua hàng thành công!","Thông báo",{timeOut:1e3,progressBar:!0,closeButton:!0});window.location="/"}else switch(n.type){case"email":toastr.error("Email đã tồn tại!","Thông báo",{timeOut:5e3,progressBar:!0,closeButton:!0});break;case"phone":toastr.error("Số điện thoại đã tồn tại!","Thông báo",{timeOut:5e3,progressBar:!0,closeButton:!0});break;default:toastr.error("Đã xảy ra lỗi!","Thông báo",{timeOut:5e3,progressBar:!0,closeButton:!0})}},error:function(){}})),!1})},validatorForm:n=>{document.querySelectorAll(n+" .field-validation-error").forEach(function(n){let t=n.parentNode;t.parentNode.removeChild(t)}),document.querySelectorAll(n+' input[type="text"][data-rule-required],'+n+' textarea[data-rule-required="true"]').forEach(function(n){if(Common.Empty(n.value)&&Common.Empty(n.getAttribute("disabled"))){let t=document.createElement("section");t.innerHTML='<section class="clearfix"><\/section><div class="field-validation-error alert alert-danger fade show" role="alert" style="display: block;">'+n.getAttribute("data-msg-required")+"<\/div>";const i=n.parentNode;i.insertBefore(t,n.nextSibling)}}),document.querySelectorAll(n+' input[type="text"][data-rule-email]').forEach(function(n){if(!Common.Empty(n.value)&&!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(n.value)&&Common.Empty(n.getAttribute("disabled"))){let t=document.createElement("section");t.innerHTML='<section class="clearfix"><\/section><div class="field-validation-error alert alert-danger fade show" role="alert" style="display: block;">'+n.getAttribute("data-msg-email")+"<\/div>";const i=n.parentNode;i.insertBefore(t,n.nextSibling)}}),document.querySelectorAll(n+' input[type="text"][data-rule-min-length],'+n+" textarea[data-rule-min-length]").forEach(function(n){if(!Common.Empty(n.value)&&n.value.length<n.getAttribute("data-rule-min-length")){let t=document.createElement("section");t.innerHTML='<section class="clearfix"><\/section><div class="field-validation-error alert alert-danger fade show" role="alert" style="display: block;">'+n.getAttribute("data-msg-min-length")+"<\/div>";const i=n.parentNode;i.insertBefore(t,n.nextSibling)}}),document.querySelectorAll(n+" select[data-rule-required]:not([multiple])").forEach(function(n){if(Common.Empty(n.getAttribute("disabled"))){var t=n.querySelectorAll("option:checked");if(t.length==0||Common.Empty(t[0].value)){let t=document.createElement("section");t.innerHTML='<section class="clearfix"><\/section><div class="field-validation-error alert alert-danger fade show" role="alert" style="display: block;">'+n.getAttribute("data-msg-required")+"<\/div>";const i=n.parentNode;i.insertBefore(t,n.nextSibling)}}})}};